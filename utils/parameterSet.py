
mlvar_tk = ['tk_pt', 'tk_eta', 'tk_phi', 'tk_dxybs','tk_dxybs_sig','tk_dz','tk_dz_sig']
mlvar_vtx = ['vtx_ntk', 'vtx_dBV', 'vtx_dBVerr']

normalize_factors_tk_EOY = [
  [7.13, 18],
  [0.1876, 1.115],
  [0.0108, 1.816],
  [3.025e-06, 0.03052],
  [0.01902, 5.188],
  [0.2271, 3.668],
  [54.45, 958.4],
]
normalize_factors_tk_UL = {
  "20161MC":[
    #[9.183334954781358, 23.636026911375808],
    #[0.1739862273800656, 1.0618152934563054],
    #[-0.012287004755910642, 1.8137608121745665],
    #[-0.00026350831557550163, 0.033002019922266104],
    #[-0.004093237366207369, 4.512014348750661],
    #[-0.11324114418125467, 3.7383584596054815],
    #[-11.197034968745818, 645.5924406994626]
    #pt ordered
    [10.422683709837754, 25.110998340399142],
    [0.014283545822007864, 1.143266340881414],
    [0.0029601228713031498, 1.8154907567069765],
    [-0.0004053834701975517, 0.032705617775989904],
    [-0.018061766118301122, 4.804114661060389],
    [-0.06581052036958832, 3.699718013168828],
    [-7.223054597574622, 678.9964200137464]
  ],
  "20161":[
    #[8.181482381573131, 19.12529256310103],
    #[0.14315116359121194, 1.0407367894362731],
    #[-0.061590026908830295, 1.813104363168493],
    #[0.00012702132165743696, 0.029517210676429442],
    #[0.01845136663766678, 4.505778902153386],
    #[0.007328222552314757, 3.4494754676675856],
    #[3.8373886561134563, 592.3079313593132]
    #pt ordered
    [9.120726686935447, 19.87863472756598],
    [0.008459874755575886, 1.114358199606721],
    [-0.0460018126231053, 1.8141156132271201],
    [-1.908423285347693e-05, 0.030019488954962127],
    [0.0058774699750424346, 4.788739393453375],
    [0.006050447828526808, 3.4560622587558423],
    [6.221389178980004, 624.1209429937811]
  ],
  "20162MC":[
    #[9.315400984992205, 23.550611077814928],
    #[0.16503238183147945, 1.077869661173089],
    #[-0.013736646542643971, 1.8249135066691602],
    #[0.000192876853446597, 0.028749091632233454],
    #[0.030090368332366495, 4.360694507410483],
    #[-0.21788138586887842, 3.4990111731623736],
    #[-26.104260889902484, 575.6274689093354]
    #pt ordered
    [10.392418683552794, 24.33142330672067],
    [0.009516516286642764, 1.1573785030527317],
    [0.013714867002744343, 1.8214270785069704],
    [0.00013057581108559516, 0.03218519859967163],
    [0.013012230278906453, 4.597476231289891],
    [-0.07748083863463143, 3.535872873815336],
    [-15.003416984960161, 604.4435480294021]
  ],
  "20162":[
    #[7.698680627372921, 17.666657323557253],
    #[0.17862642732774886, 1.088304332366292],
    #[-0.05789315634337729, 1.8235603738374189],
    #[-0.00019809461462200396, 0.033320449906567545],
    #[-0.006913440530618813, 4.428823258765319],
    #[0.13479904036436763, 3.52236688988952],
    #[19.429961886362303, 561.1913581154208]
    #pt ordered
    [8.887508461667377, 18.48645303100236],
    [0.02013115905179801, 1.147169132880633],
    [-0.0692827537139611, 1.831233894945651],
    [0.0001675771821406869, 0.0287496191704377],
    [0.020508549321598898, 4.672622064241244],
    [0.08315157359033158, 3.5418607068710504],
    [14.754556157235124, 596.9197470362584]
  ],
  "2017MC":[
    #[7.319827158117112, 17.923932769581018],
    #[0.1705107572284987, 1.1180865487668386],
    #[0.029649947996248694, 1.8023224071145774],
    #[8.117281021760651e-05, 0.02242394347880475],
    #[-0.004464198209738281, 4.236904063924716],
    #[-0.6538881931255772, 3.710799282685401],
    #[-120.50101704461981, 850.64993037136]
    #pt ordered
    [8.046923675388886, 18.52570533447482],
    [0.023625038786796268, 1.1884450466492393],
    [0.009355101013838773, 1.8004060695262967],
    [-0.00010584906260662, 0.026184759814602707],
    [-0.007107910345056732, 4.445730828730106],
    [-0.44354193878070186, 3.7054870736120766],
    [-97.90984242504999, 887.4976764164333]
  ],
  "2017":[
    #[6.712935807390548, 17.45712367933874],
    #[0.14317085049516493, 1.107665708876823],
    #[-0.01387718266805023, 1.8042587015882459],
    #[6.885729723579261e-05, 0.02460794980303288],
    #[-0.0029846925850818694, 4.39093343812936],
    #[0.059240021458214914, 3.6633767212263595],
    #[14.537684717563884, 757.1724900064688]
    #pt ordered
    [7.419532745095614, 17.63337665398873],
    [0.010555807687440064, 1.173090588944838],
    [-0.020648869426206324, 1.8023818349134861],
    [-2.9603147092186068e-05, 0.024639152604041398],
    [-0.006039546005174064, 4.612342159012455],
    [0.048613807374259306, 3.669032641378968],
    [12.2120168950683, 795.0525041559923]
  ],
  "2018MC":[
    #[6.87761527714606, 16.42720878739661],
    #[0.12621996589542298, 1.1444403710105255],
    #[0.061893112193528846, 1.8373181969152288],
    #[5.485766645217457e-07, 0.02450368737229533],
    #[-0.007976573377049533, 4.37089582952562],
    #[-0.24707312896961844, 3.39170075383676],
    #[-47.278571550629, 698.8799378606054]
    #pt ordered
    [7.5395539870574, 16.639312906335828],
    [-0.014878959539459788, 1.20128907469872],
    [0.06831615585137395, 1.833947856858854],
    [0.00014272767741978852, 0.024112107914500303],
    [0.007618131509978066, 4.575648834982338],
    [-0.17462101792704857, 3.426658161620025],
    [-40.71731371689321, 733.4199504642861]
  ],
  "2018":[
    #[6.5890798108880775, 16.52869961337581],
    #[0.08206238523351589, 1.1335623391182246],
    #[0.08660554158041599, 1.8363829127132902],
    #[7.033743884535698e-06, 0.023785978816452863],
    #[-0.0065892407262641015, 4.399313416375137],
    #[-0.08709977906185637, 3.319998189594504],
    #[-17.67532422367329, 631.3640327399293]
    #pt ordered
    [7.235196194645989, 16.83239163321486],
    [-0.03103526634622309, 1.1979754103692741],
    [0.07427221377702535, 1.8389898965672],
    [3.2869307396026636e-05, 0.024213123544205087],
    [-0.005829281698824771, 4.644330508651762],
    [-0.07109372543568944, 3.3473491085758913],
    [-16.923127109579504, 662.5684608251681]
  ],
}
normalize_factors_vtx_UL = {
  "20161MC":[
    [3.2097449579402726, 0.45782965189851477],
    [0.0258969235980135, 0.06913076844789563],
    [0.0016677700109852852, 0.00046633470943741273]
  ],
  "20161":[
    [3.2401315789473686, 0.5048136535319172],
    [0.025525625411414933, 0.018401741189753948],
    [0.0017146498177297825, 0.0004680109783344373]
  ],
  "20162MC":[
    [3.2177684318988553, 0.47139104827901007],
    [0.02394812302947708, 0.015232157360907654],
    [0.0016942553297230709, 0.00048815500759292097]
  ],
  "20162":[
    [3.213953488372093, 0.4480351913861104],
    [0.026599844324207582, 0.01921508221891856],
    [0.0017632288741879164, 0.00043366492345007433]
  ],
  "2017MC":[
    [3.1946203313166763, 0.4720273542039203],
    [0.024975178620271328, 0.029378532265422672],
    [0.001702555716092466, 0.0004681740620782141]
  ],
  "2017":[
    [3.182741116751269, 0.43371657587580276],
    [0.025947371816643385, 0.01621871499668949],
    [0.0017953352742599788, 0.00043068723512371414]
  ],
  "2018MC":[
    [3.146778906353386, 0.38700218673691866],
    [0.024537672869607115, 0.019976841101964335],
    [0.001716546392867653, 0.00046246456287888917]
  ],
  "2018":[
    [3.199440820130475, 0.4541613169971124],
    [0.025706772074947013, 0.020228821869093673],
    [0.0017636812024653039, 0.00045871403908471326]
  ],
}
normalize_factors_vtx_EOY = [
  [3.634, 0.3758],
  [0.02555, 0.02167],
  [0.001634, 0.0004853],
]

No = 50
Ds = len(mlvar_tk)
Nr = No*(No-1)
Dp = 20
Dv = len(mlvar_vtx)
Dv_ori = len(mlvar_vtx)
Dr = 1
De = 20
#lambda_dcorr = 0.5
lambda_param = 0.00005 # was 0.005
lambda_dcorr_met = 0
lr = 0.0003
use_dR = False
num_epochs=250

includeData = True
isUL = True
#fndir = "/uscms/home/ali/nobackup/LLP/crabdir/MLTreeULV4_norefit_keeptkMETm/"
#fndir = "root://cmseos.fnal.gov//store/user/ali/MLTree_trackdxysig0p5_ULV4_norefit_keeptkMETm/"
#fndir = "/uscms/home/ali/nobackup/LLP/crabdir/MLTreeULV3_keeptkMETm/"
#fndir = "/uscms/home/ali/nobackup/LLP/crabdir/MLTreeULV11METm/"
#fndir = "/uscms/home/ali/nobackup/LLP/crabdir/MLTree_nofakeMETveto_ULV11METm/"
fndir = "/uscms/home/ali/nobackup/LLP/crabdir/MLTree_new_ULV13METm/"
dir_model = "./model_0801_ntk_ULV13/"

#fns_bkg = [
#    "qcdht0200_2017",
#    "qcdht0300_2017",
#    "qcdht0500_2017",
#    "qcdht0700_2017",
#    "qcdht1000_2017",
#    "qcdht1500_2017",
#    "qcdht2000_2017",
#    "wjetstolnusum_2017",
#    "zjetstonunuht0100_2017",
#    "zjetstonunuht0200_2017",
#    "zjetstonunuht0400_2017",
#    "zjetstonunuht0600_2017",
#    "zjetstonunuht0800_2017",
#    "zjetstonunuht1200_2017",
#    "zjetstonunuht2500_2017",
#    "ttbar_2017",
#]
#fns_signal = [
#    "mfv_splitSUSY_tau000000000um_M2000_1800_2017",
#    "mfv_splitSUSY_tau000000000um_M2000_1900_2017",
#    "mfv_splitSUSY_tau000000300um_M2000_1800_2017",
#    "mfv_splitSUSY_tau000000300um_M2000_1900_2017",
#    "mfv_splitSUSY_tau000001000um_M2000_1800_2017",
#    "mfv_splitSUSY_tau000001000um_M2000_1900_2017",
#    "mfv_splitSUSY_tau000010000um_M2000_1800_2017",
#    "mfv_splitSUSY_tau000010000um_M2000_1900_2017",
#]

fns_data = {
  "20161": [
        'MET20161B2',
        'MET20161C',
        'MET20161D',
        'MET20161E',
        'MET20161F',
  ],
  "20162": [
        'MET20162F',
        'MET20162G',
        'MET20162H',
  ],
  "2017": [
        'MET2017B',
        'MET2017C',
        'MET2017D',
        'MET2017E',
        'MET2017F',
  ],
  "2018": [
        'MET2018A',
        'MET2018B',
        'MET2018C',
        'MET2018D',
  ],
}
fns_bkg = [
    "qcdht0100_",
    "qcdht0200_",
    "qcdht0300_",
    "qcdht0500_",
    "qcdht0700_",
    "qcdht1000_",
    "qcdht1500_",
    "qcdht2000_",
    "wjetstolnuht0100_",
    "wjetstolnuht0200_",
    "wjetstolnuht0400_",
    "wjetstolnuht0600_",
    "wjetstolnuht0800_",
    "wjetstolnuht1200_",
    "wjetstolnuht2500_",
    "zjetstonunuht0100_",
    "zjetstonunuht0200_",
    "zjetstonunuht0400_",
    "zjetstonunuht0600_",
    "zjetstonunuht0800_",
    "zjetstonunuht1200_",
    "zjetstonunuht2500_",
    "ww_",
    "wz_",
    "zz_",
    "st_tchan_antitop_",
    "st_tchan_top_",
    "st_tw_antitop_",
    "st_tw_top_",
    "ttbar_",
]
fns_signal = [
    "mfv_splitSUSY_tau000000100um_M1400_1200_",
    "mfv_splitSUSY_tau000000100um_M1400_1300_",
    "mfv_splitSUSY_tau000000100um_M1600_1400_",
    "mfv_splitSUSY_tau000000100um_M1600_1500_",
    "mfv_splitSUSY_tau000000100um_M1800_1600_",
    "mfv_splitSUSY_tau000000100um_M1800_1700_",
    "mfv_splitSUSY_tau000000100um_M2000_1800_",
    "mfv_splitSUSY_tau000000100um_M2000_1900_",
    "mfv_splitSUSY_tau000000100um_M2200_2000_",
    "mfv_splitSUSY_tau000000100um_M2200_2100_",
    "mfv_splitSUSY_tau000000100um_M2400_2200_",
    "mfv_splitSUSY_tau000000100um_M2400_2300_",
    "mfv_splitSUSY_tau000000100um_M2600_2400_",
    "mfv_splitSUSY_tau000000100um_M2600_2500_",
    "mfv_splitSUSY_tau000000300um_M1400_1200_",
    "mfv_splitSUSY_tau000000300um_M1400_1300_",
    "mfv_splitSUSY_tau000000300um_M1600_1400_",
    "mfv_splitSUSY_tau000000300um_M1600_1500_",
    #"mfv_splitSUSY_tau000000300um_M1800_1600_",
    "mfv_splitSUSY_tau000000300um_M1800_1700_",
    "mfv_splitSUSY_tau000000300um_M2000_1800_",
    "mfv_splitSUSY_tau000000300um_M2000_1900_",
    "mfv_splitSUSY_tau000000300um_M2200_2000_",
    "mfv_splitSUSY_tau000000300um_M2200_2100_",
    "mfv_splitSUSY_tau000000300um_M2400_2200_",
    "mfv_splitSUSY_tau000000300um_M2400_2300_",
    "mfv_splitSUSY_tau000000300um_M2600_2400_",
    "mfv_splitSUSY_tau000000300um_M2600_2500_",
    "mfv_splitSUSY_tau000001000um_M1400_1200_",
    "mfv_splitSUSY_tau000001000um_M1400_1300_",
    #"mfv_splitSUSY_tau000001000um_M1600_1400_",
    #"mfv_splitSUSY_tau000001000um_M1600_1500_",
    "mfv_splitSUSY_tau000001000um_M1800_1600_",
    "mfv_splitSUSY_tau000001000um_M1800_1700_",
    "mfv_splitSUSY_tau000001000um_M2000_1800_",
    "mfv_splitSUSY_tau000001000um_M2000_1900_",
    #"mfv_splitSUSY_tau000001000um_M2200_2000_",
    #"mfv_splitSUSY_tau000001000um_M2200_2100_",
    "mfv_splitSUSY_tau000001000um_M2400_2200_",
    "mfv_splitSUSY_tau000001000um_M2400_2300_",
    "mfv_splitSUSY_tau000001000um_M2600_2400_",
    "mfv_splitSUSY_tau000001000um_M2600_2500_",
    #"mfv_splitSUSY_tau000003000um_M1400_1200_",
    #"mfv_splitSUSY_tau000003000um_M1400_1300_",
    "mfv_splitSUSY_tau000003000um_M1600_1400_",
    "mfv_splitSUSY_tau000003000um_M1600_1500_",
    #"mfv_splitSUSY_tau000003000um_M1800_1600_",
    #"mfv_splitSUSY_tau000003000um_M1800_1700_",
    "mfv_splitSUSY_tau000003000um_M2000_1800_",
    "mfv_splitSUSY_tau000003000um_M2000_1900_",
    "mfv_splitSUSY_tau000003000um_M2200_2000_",
    "mfv_splitSUSY_tau000003000um_M2200_2100_",
    #"mfv_splitSUSY_tau000003000um_M2400_2200_",
    #"mfv_splitSUSY_tau000003000um_M2400_2300_",
    "mfv_splitSUSY_tau000003000um_M2600_2400_",
    "mfv_splitSUSY_tau000003000um_M2600_2500_",
    #"mfv_splitSUSY_tau000010000um_M1400_1200_",
    #"mfv_splitSUSY_tau000010000um_M1400_1300_",
    #"mfv_splitSUSY_tau000010000um_M1600_1400_",
    #"mfv_splitSUSY_tau000010000um_M1600_1500_",
    "mfv_splitSUSY_tau000010000um_M1800_1600_",
    "mfv_splitSUSY_tau000010000um_M1800_1700_",
    #"mfv_splitSUSY_tau000010000um_M2000_1800_",
    #"mfv_splitSUSY_tau000010000um_M2000_1900_",
    "mfv_splitSUSY_tau000010000um_M2200_2000_",
    "mfv_splitSUSY_tau000010000um_M2200_2100_",
    #"mfv_splitSUSY_tau000010000um_M2400_2200_",
    #"mfv_splitSUSY_tau000010000um_M2400_2300_",
    "mfv_splitSUSY_tau000010000um_M2600_2400_",
    "mfv_splitSUSY_tau000010000um_M2600_2500_",
    "mfv_splitSUSY_tau000030000um_M1400_1200_",
    "mfv_splitSUSY_tau000030000um_M1400_1300_",
    #"mfv_splitSUSY_tau000030000um_M1600_1400_",
    #"mfv_splitSUSY_tau000030000um_M1600_1500_",
    #"mfv_splitSUSY_tau000030000um_M1800_1600_",
    #"mfv_splitSUSY_tau000030000um_M1800_1700_",
    "mfv_splitSUSY_tau000030000um_M2000_1800_",
    "mfv_splitSUSY_tau000030000um_M2000_1900_",
    #"mfv_splitSUSY_tau000030000um_M2200_2000_",
    #"mfv_splitSUSY_tau000030000um_M2200_2100_",
    #"mfv_splitSUSY_tau000030000um_M2400_2200_",
    #"mfv_splitSUSY_tau000030000um_M2400_2300_",
    "mfv_splitSUSY_tau000030000um_M2600_2400_",
    "mfv_splitSUSY_tau000030000um_M2600_2500_",
    #"mfv_splitSUSY_tau000100000um_M1400_1200_",
    #"mfv_splitSUSY_tau000100000um_M1400_1300_",
    #"mfv_splitSUSY_tau000100000um_M1600_1400_",
    #"mfv_splitSUSY_tau000100000um_M1600_1500_",
    #"mfv_splitSUSY_tau000100000um_M1800_1600_",
    #"mfv_splitSUSY_tau000100000um_M1800_1700_",
    #"mfv_splitSUSY_tau000100000um_M2000_1800_",
    #"mfv_splitSUSY_tau000100000um_M2000_1900_",
    #"mfv_splitSUSY_tau000100000um_M2200_2000_",
    #"mfv_splitSUSY_tau000100000um_M2200_2100_",
    #"mfv_splitSUSY_tau000100000um_M2400_2200_",
    #"mfv_splitSUSY_tau000100000um_M2400_2300_",
    #"mfv_splitSUSY_tau000100000um_M2600_2400_",
    #"mfv_splitSUSY_tau000100000um_M2600_2500_",
    #"mfv_splitSUSY_tau000300000um_M1400_1200_",
    #"mfv_splitSUSY_tau000300000um_M1400_1300_",
    #"mfv_splitSUSY_tau000300000um_M1600_1400_",
    #"mfv_splitSUSY_tau000300000um_M1600_1500_",
    #"mfv_splitSUSY_tau000300000um_M1800_1600_",
    #"mfv_splitSUSY_tau000300000um_M1800_1700_",
    #"mfv_splitSUSY_tau000300000um_M2000_1800_",
    #"mfv_splitSUSY_tau000300000um_M2000_1900_",
    #"mfv_splitSUSY_tau000300000um_M2200_2000_",
    #"mfv_splitSUSY_tau000300000um_M2200_2100_",
    #"mfv_splitSUSY_tau000300000um_M2400_2200_",
    #"mfv_splitSUSY_tau000300000um_M2400_2300_",
    #"mfv_splitSUSY_tau000300000um_M2600_2400_",
    #"mfv_splitSUSY_tau000300000um_M2600_2500_",
    #"mfv_splitSUSY_tau001000000um_M1400_1200_",
    #"mfv_splitSUSY_tau001000000um_M1400_1300_",
    #"mfv_splitSUSY_tau001000000um_M1600_1400_",
    #"mfv_splitSUSY_tau001000000um_M1600_1500_",
    #"mfv_splitSUSY_tau001000000um_M1800_1600_",
    #"mfv_splitSUSY_tau001000000um_M1800_1700_",
    #"mfv_splitSUSY_tau001000000um_M2000_1800_",
    #"mfv_splitSUSY_tau001000000um_M2000_1900_",
    #"mfv_splitSUSY_tau001000000um_M2200_2000_",
    #"mfv_splitSUSY_tau001000000um_M2200_2100_",
    #"mfv_splitSUSY_tau001000000um_M2400_2200_",
    #"mfv_splitSUSY_tau001000000um_M2400_2300_",
    #"mfv_splitSUSY_tau001000000um_M2600_2400_",
    #"mfv_splitSUSY_tau001000000um_M2600_2500_",

    #"mfv_splitSUSY_tau000000100um_M2000_1800_2017",
    #"mfv_splitSUSY_tau000000100um_M2000_1900_2017",
    #"mfv_splitSUSY_tau000000100um_M2400_2300_2017",
    #"mfv_splitSUSY_tau000000300um_M2000_1800_2017",
    #"mfv_splitSUSY_tau000000300um_M2000_1900_2017",
    #"mfv_splitSUSY_tau000000300um_M2400_2300_2017",
    #"mfv_splitSUSY_tau000001000um_M2000_1800_2017",
    #"mfv_splitSUSY_tau000001000um_M2000_1900_2017",
    #"mfv_splitSUSY_tau000001000um_M1200_1100_2017",
    #"mfv_splitSUSY_tau000001000um_M1400_1200_2017",
    #"mfv_splitSUSY_tau000001000um_M2400_2300_2017",
    #"mfv_splitSUSY_tau000010000um_M2000_1800_2017",
    #"mfv_splitSUSY_tau000010000um_M2400_2300_2017",
    ##"mfv_splitSUSY_tau000010000um_M1200_1100_2017",
    #"mfv_splitSUSY_tau000010000um_M1400_1200_2017",
    #"mfv_splitSUSY_tau000010000um_M2000_1900_2017",
]

